import unittest
import pandas as pd
import requests
import json
from services.utilities import utils_func
from copy import deepcopy

dct = {
    "GR": [
        97.08399212598434,
        97.50363031496059,
        93.21476850393665,
        87.87277322834629,
        86.62054409448697,
        90.28891456692942,
        95.24660905511828,
        96.73783149606297,
        97.41823937007882,
        96.67511968503922,
        95.3123440944882,
        93.60343110236204,
        93.68469803149108,
        93.24025787401557,
        90.96946771653539,
        87.66171181102337,
        88.01311338582704,
        90.45362559055116,
        89.34992637795268,
        87.20470708661405,
        84.95672795275878,
        89.34880787401622,
        94.09313661417322,
        96.65455826771677,
        93.75132480314913,
        85.96050236220447,
        79.4958082677162,
        78.0367118110238,
        81.71914921259294,
        84.2353362204725,
        82.25980748031472,
        79.35068779527555,
        80.22996456692925,
        84.16613188976403,
        87.18194212598429,
        86.04472007874001,
        83.77995196850628,
        82.21290669291332,
        84.24430708661443,
        87.0258165354331,
        90.61898425196881,
        94.89896023622057,
        97.76560748031511,
        98.45323228346447,
        96.28759645669678,
        93.41084803149592,
        92.99889606299222,
        96.4868909448821,
        100.29271850393715,
        99.63400078740139,
        92.77156574803105,
        88.75007322834651,
        89.46041299212528,
        92.72526259842547,
        95.12666023622045,
        96.60959212598442,
        97.41676968503928,
        96.64585748031496,
        95.61482598425188,
        96.00592440944894,
        95.79611732283874,
        94.51815748031495,
        95.45752007874025,
        97.04580984251976,
        98.40990629921266,
        97.06931338582659,
        94.3851444881889,
        94.2285452755906,
        93.18961496063466,
        93.20312834645682,
        92.12222913385804,
        89.9879188976378,
        89.52178307086609,
        89.01967165354331,
        92.69440314960663,
        97.43826535433084,
        100.04681259842134,
        100.96656259842517,
        98.98284763779512,
        98.40746141732292,
        98.34592401574794,
        99.10439251968519,
        97.16384960629891,
        92.71082677165343,
        92.09567480314786,
        95.58399488189002,
        99.69314842519698,
        98.7804653543305,
        98.02523858267728,
        98.22946181102354,
        98.96293464566943,
        100.36787755905512,
        100.57702992125913,
        98.62010078740138,
        93.64209015748006,
        90.85002519685038,
        90.34615748031491,
        90.20545472440948,
        88.59332362204708,
        87.59218976377959,
        88.27686692913366,
        89.585590944882,
        91.08713110236224,
        89.47047401574785,
        86.33939094488177,
        84.16970118110228,
        83.19497322834644,
        82.03530314960621,
        79.75679881890149,
        77.11250984251956,
        76.56038188976385,
        76.49687834645663,
        78.52260157480339,
        79.19437992125968,
        75.0408460629919,
        69.75895511810997,
        66.01174015748329,
        67.06136968503955,
        68.21553385826766,
        67.28387795275587,
        66.21262125984245,
        64.56184685039362,
        64.92483976377964,
        66.15659370078741,
        71.13096456691503,
        78.75438661417351,
        83.95066417322855,
        86.61051889763785,
        86.56013779527554,
        87.50600866141745,
        89.79481023622056,
        90.08046614173223,
        89.73052086614122,
        89.21658110236216,
        88.60349842519686,
        89.31428503937015,
        91.49900039370092,
        94.73726181102379,
        96.56831377952757,
        95.68755826771644,
        96.14316417322432,
        97.31553307086612,
        97.95252755905518,
        97.55319212598417,
        96.85025078740159,
        100.00889094488215,
        104.6244334645671,
        107.05617559055123,
        103.92890393701865,
        99.27237874015736,
        98.9363397637796,
        96.45254685039342,
        92.12654921259829,
        90.0034224409448,
        92.63200708661448,
        95.43419370078738,
        95.63650551180964,
        97.98660433070883,
        99.97693543307088,
        98.33295472440928,
        94.03164566929111,
        93.78509330708681,
        95.39140118110232,
        94.69020314960626,
        92.9081433070907,
        93.04619094488201,
        95.91836811023636,
        97.67516141732287,
        98.23327125984255,
        97.15695787401563,
        94.63652047244082,
        90.42328307086588,
        85.54336141732904,
        83.57220393700787,
        85.48922952755923,
        89.16493464566946,
        91.13978700787403,
        90.36292637795266,
        86.22962362204696,
        82.66260551181097,
        80.90149291338928,
        82.78922204724437,
        84.18116456692903,
        83.7293681102363,
        84.3889527559055,
        86.63234448818918,
        88.67273779527558,
        88.44891417322833,
        88.17894173228369,
        87.3819413385826,
        86.84665000000001,
        84.9620444881888,
        80.679886614173,
        73.3708574803145,
        68.46468188976375,
        70.67084251968527,
        78.27298425195302,
        84.48137244094501,
        86.00570039370082,
        85.48023503937,
        85.84081417322844,
        84.21424724409425,
        82.20709409448823,
        81.20570944881878,
        81.7672043307035,
        80.64989999999976,
        76.75493543307074,
        74.6145476377952,
        73.34218346456689,
        70.4757775590549,
        64.37623700787367,
        59.65832559055107,
        57.08201574803586,
        56.68896889763788,
        57.78118464566931,
        58.086880314960645,
        57.99926141732282,
        56.37380314960617,
        58.32022283464596,
        66.22417047244139,
        76.16566299211021,
        79.7969370078739,
        73.23713070866094,
        63.587197244094064,
        57.66701968503923,
        56.11465354330708,
        56.18172165354332,
        56.09253307086612,
        55.91430078740143,
        56.29026771653546,
        57.984191338582804,
        59.45482755905513,
        57.24725629921238,
        53.70752165354318,
        51.737294488188915,
        52.822021653543466,
        53.83661574803316,
        54.84613188976392,
        56.25292440944882,
        57.8390263779529,
        59.42791574803151,
        60.79844566929145,
        62.52394921259848,
        61.683455905511686,
        58.154471653549855,
        55.00362952755896,
        54.33898661417326,
        56.206243700787546,
        58.128974409448865,
        60.01869960629934,
        58.96485984251947,
        55.53054606299201,
        53.32240511811324,
        53.95207440944896,
        56.69979094488201,
        60.5600606299215,
        62.319766141732224,
        58.88686535433045,
        51.50322204724366,
        47.00968503937007,
        48.17495393700419,
        49.777521653543346,
        51.32526220472451,
        53.1539366141733,
        54.72086259842527,
        55.13089173228343,
        53.952418110236145,
        55.07167047244111,
        56.855029921259664,
        57.275755511811056,
        56.45175157480305,
        55.95540629921265,
        56.15736062992123,
        56.05394330708663,
        56.38184803149608,
        57.57497637795285,
        59.257287795273456,
        58.93435157480306,
        56.263927165354175,
        54.4239838582677,
        54.17660275590551,
        55.619186614173366,
        55.61984173228334,
        54.15669685039368,
        53.79378858267758,
        54.57215157480323,
        55.73950118110239,
        57.63819842519699,
        60.96420708661434,
        64.46938188976394,
        63.425105511810784,
        60.08533858267708,
        56.66764291339333,
        56.73525000000022,
        57.79650590551171,
        56.848561023622054,
        56.88235236220472,
        56.408923622047205,
        58.63873937007897,
        61.44401456692917,
        65.3552094488087,
        70.43301102362221,
        75.82248937007907,
        81.63729055118132,
        84.69417834645677,
        83.74314999999984,
        80.52208661417308,
        76.916944094488,
        75.46174881889638,
        74.02024370078723,
        71.91002834645666,
        69.75454803149591,
        68.469425984252,
        69.05763425196854,
        68.10727716535422,
        65.78412755905501,
        63.786226771656146,
        62.31054015748026,
        61.20883267716531,
        59.24240669291325,
        57.13121220472434,
        55.549159055118025,
        55.30827086614178,
        56.93348543307096,
        58.62464999999798,
        59.69534409448823,
        60.405725590551214,
        61.69166574803159,
        62.592179527559054,
        61.89628897637789,
        60.30057598425188,
        62.52067952755933,
        66.08201181102149,
        67.18955826771658,
        62.90696574803108,
        56.58681968503919,
        55.07518818897641,
        56.44813700787411,
        59.92971141732306,
        62.951110629921324,
        64.62904645668993,
        64.18238503936995,
        59.911888582676895,
        54.97874645669272,
        51.30175511811009,
        51.205029133858396,
        53.72399881889775,
        58.44952244094521,
        63.142061417318786,
        64.92113740157484,
        63.14117874015728,
        60.385846850393634,
        61.16697755905525,
        63.08812165354336,
        62.18290629921246,
        59.03919999999984,
        58.16908425196626,
        60.814619685039546,
        62.99514645669295,
        63.616055905511836,
        62.19654448818883,
        61.99833661417335,
        62.69254921259838,
        61.52983031496056,
        57.149413779538335,
        51.68947086614155,
        51.01286692913397,
        54.97541811023648,
        58.74257874015758,
        59.26659606299208,
        60.28381889763793,
        65.68611259842557,
        72.98739055117059,
        76.73170393700791,
        75.95034251968494,
        72.93386141732266,
        69.58920354330694,
        67.43383346456687,
        66.11316259842513,
        64.7778322834645,
        62.294470866141566,
        60.87796653543374,
        60.35863070866135,
        58.59505787401565,
        59.11463425196864,
        63.0990759842522,
        68.98617007874047,
        70.13810393700768,
        66.63838661417309,
        63.160968503931436,
        61.03776062992123,
        59.911862204724336,
        58.4579854330708,
        59.404240944882034,
        62.47636062992141,
        65.55892559055133,
        66.29909133858261,
        66.18854251968654,
        65.70349488188968,
        63.90308582677157,
        62.717701574803115,
        62.5327283464567,
        63.00795433070869,
        64.55078661417333,
        66.74224645669301,
        67.05998582676979,
        61.781530314960214,
        56.7857759842519,
        56.966759448818976,
        60.77288818897665,
        64.43775905511819,
        65.92484094488195,
        66.30079370078738,
        65.73513503936906,
        64.19175787401564,
        63.97722952755913,
        62.83396062992109,
        60.52047834645664,
        58.32158346456677,
        60.244925984252276,
        67.33137204724444,
        74.60010354331746,
        78.13995236220474,
        77.23062952755896,
        72.99756338582648,
        68.02592204724391,
        67.03701102362213,
        72.19298267716576,
        78.27232244094508,
        82.45293740158122,
        83.32889881889753,
        82.89663779527565,
        82.00368897637782,
        82.8338622047246,
        86.46822283464581,
        89.12735787401586,
        89.40387204724402,
        88.79474763779557,
        90.98022834645688,
        91.90588228346448,
        89.98792637795266,
        85.62552598425167,
        83.72567913385838,
        85.31758307086619,
        87.56461574803166,
        88.42075275590331,
        86.2507019685038,
        84.50093818897633,
        85.20378582677175,
        88.9238232283467,
        91.40888937007874,
        89.95430275590537,
        87.42998622047233,
        86.70194173228447,
        86.97437283464566,
        87.10645314960631,
        88.42544960629931,
        90.50458307086623,
        90.07943582677153,
        87.37113503936995,
        86.33703976377954,
        88.03472362205123,
        88.93409409448815,
        86.93741929133843,
        81.79539842519652,
        77.24096929133847,
        79.14150905511838,
        85.02898543307114,
        88.13124527559057,
        89.65415866142096,
        92.50525000000015,
        94.75283897637802,
        92.36547795275564,
        88.53987125984243,
        87.09842637795272,
        86.21996574803146,
        85.90133385826772,
        87.18468031496403,
        88.65964291338587,
        87.78470118110225,
        88.89735393700808,
        89.83350118110226,
        88.46930787401571,
        88.7520984251969,
        89.20436692913385,
        88.79130866141647,
        86.63633937007857,
        87.46986574803172,
        92.33166377952779,
        93.63809566929125,
        91.82305354330701,
        88.64508937007852,
        85.74898582677159,
        85.90329251968737,
        86.05540708661411,
        87.32217795275606,
        87.40154921259828,
        87.13606811023632,
        85.59286102362181,
        83.5387728346457,
        86.00732362204744,
        89.81257204724919,
        91.56127637795277,
        89.93220866141718,
        89.05431338582683,
        89.56871377952756,
        88.92774291338579,
        87.27837952755895,
        85.62200314960624,
        84.94765314960596,
        83.91265944881881,
        84.9674641732285,
        89.70664921259869,
        89.49476259842493,
        80.24084133858209,
        66.49711535433,
        56.871572440944654,
        52.91518858267259,
        52.241272047244166,
        55.212095275590755,
        63.904539370079334,
        77.00019960629984,
        89.16681220472493,
        92.83529763779514,
        88.86937322834622,
        84.13907362204043,
        83.4506417322836,
        85.25923307086617,
        86.86048937007885,
        90.20733503937028,
        92.81178858267721,
        93.3243811023622,
        90.77956338582653,
        87.09741811023238,
        84.50485905511799,
        82.67039370078734,
        82.48062244094491,
        82.76451181102361,
        83.0859507874016,
        83.1196492125984,
        84.66694448818915,
        86.92858228346627,
        87.06688188976375,
        85.59822401574795,
        84.42244173228345,
        83.89177322834642,
        84.04479803149611,
        86.20073346456708,
        89.93794448818917,
        91.79514881889729,
        90.33188858267705,
        89.03332952755905,
        88.8685031496063,
        88.9122035433071,
        89.15401023622049,
        90.64000629921271,
        91.260079527559,
        89.03532322834184,
        86.25761023622036,
        84.92564606299212,
        86.54371338582693,
        87.07103582677155,
        86.27991102362206,
        85.9124047244094,
        87.78416653543329,
        89.44153976377814,
        89.47379330708665,
        91.12166771653554,
        94.88769251968527,
        98.84985984251982,
        96.80875944881859,
        92.94221692913379,
        89.53962519685014,
        87.7654744094508,
        86.359644094488,
        81.93086023622024,
        77.07918818897615,
        73.75299842519675
    ],
    "TVD": [
        3550.058242913386,
        3550.2102905511815,
        3550.362342913386,
        3550.5144429133857,
        3550.6665429133855,
        3550.8186429133857,
        3550.970690551181,
        3551.122742913386,
        3551.274842913386,
        3551.426942913386,
        3551.579042913386,
        3551.7310905511813,
        3551.8831429133857,
        3552.035242913386,
        3552.1873429133857,
        3552.339442913386,
        3552.4915429133857,
        3552.643590551181,
        3552.795642913386,
        3552.947742913386,
        3553.0998429133856,
        3553.251942913386,
        3553.404042913386,
        3553.556090551181,
        3553.708142913386,
        3553.8602429133857,
        3554.012342913386,
        3554.1644429133858,
        3554.3165429133855,
        3554.468642913386,
        3554.620742913386,
        3554.7727905511815,
        3554.924842913386,
        3555.0769429133857,
        3555.229042913386,
        3555.3811429133857,
        3555.5332429133855,
        3555.6853429133857,
        3555.837442913386,
        3555.989542913386,
        3556.141642913386,
        3556.293742913386,
        3556.4457905511813,
        3556.597842913386,
        3556.749942913386,
        3556.9020429133857,
        3557.054142913386,
        3557.2062429133857,
        3557.358342913386,
        3557.5104429133858,
        3557.662542913386,
        3557.814642913386,
        3557.9667429133856,
        3558.118842913386,
        3558.270942913386,
        3558.423042913386,
        3558.5751429133857,
        3558.727242913386,
        3558.8793429133857,
        3559.031442913386,
        3559.1835429133857,
        3559.335642913386,
        3559.487742913386,
        3559.639842913386,
        3559.791942913386,
        3559.944042913386,
        3560.096142913386,
        3560.248242913386,
        3560.400342913386,
        3560.5524429133857,
        3560.704542913386,
        3560.8566429133857,
        3561.008742913386,
        3561.1608429133857,
        3561.312942913386,
        3561.465042913386,
        3561.6171952755903,
        3561.769342913386,
        3561.921442913386,
        3562.073542913386,
        3562.225642913386,
        3562.377742913386,
        3562.529842913386,
        3562.6819429133857,
        3562.8340429133855,
        3562.9861429133857,
        3563.138242913386,
        3563.2903429133858,
        3563.4424952755903,
        3563.594642913386,
        3563.746742913386,
        3563.898842913386,
        3564.050942913386,
        3564.203042913386,
        3564.355142913386,
        3564.5072429133857,
        3564.6593952755907,
        3564.811542913386,
        3564.9636429133857,
        3565.115742913386,
        3565.2678429133857,
        3565.419942913386,
        3565.5720952755905,
        3565.7242429133858,
        3565.876342913386,
        3566.028442913386,
        3566.180542913386,
        3566.332642913386,
        3566.4847952755904,
        3566.636942913386,
        3566.789042913386,
        3566.941142913386,
        3567.093242913386,
        3567.2453952755905,
        3567.3975429133857,
        3567.549642913386,
        3567.7017429133857,
        3567.8538952755903,
        3568.006042913386,
        3568.1581429133857,
        3568.310242913386,
        3568.462342913386,
        3568.6144952755903,
        3568.766642913386,
        3568.918742913386,
        3569.070842913386,
        3569.2229952755906,
        3569.375142913386,
        3569.527242913386,
        3569.679342913386,
        3569.8314952755904,
        3569.9836429133857,
        3570.1357429133855,
        3570.2878952755905,
        3570.4400429133857,
        3570.592142913386,
        3570.7442429133857,
        3570.8963952755903,
        3571.048542913386,
        3571.2006429133858,
        3571.3527952755903,
        3571.504942913386,
        3571.657042913386,
        3571.8091952755904,
        3571.961342913386,
        3572.113442913386,
        3572.2655952755904,
        3572.417742913386,
        3572.569842913386,
        3572.7219952755904,
        3572.874142913386,
        3573.026242913386,
        3573.1783952755904,
        3573.3305429133857,
        3573.482642913386,
        3573.6347952755905,
        3573.7869429133857,
        3573.939042913386,
        3574.0911952755905,
        3574.2433429133857,
        3574.3954952755903,
        3574.547642913386,
        3574.6997429133858,
        3574.8518952755903,
        3575.0040429133855,
        3575.1561952755906,
        3575.308342913386,
        3575.460442913386,
        3575.6125952755906,
        3575.764742913386,
        3575.9168952755904,
        3576.069042913386,
        3576.221142913386,
        3576.3732952755904,
        3576.525442913386,
        3576.6775952755906,
        3576.829742913386,
        3576.9818952755904,
        3577.1340429133857,
        3577.2861952755907,
        3577.438342913386,
        3577.5904429133857,
        3577.7425952755902,
        3577.894742913386,
        3578.0468952755905,
        3578.1990429133857,
        3578.3511952755903,
        3578.503342913386,
        3578.6554952755905,
        3578.8076429133857,
        3578.9597952755903,
        3579.111942913386,
        3579.2640952755905,
        3579.4162429133858,
        3579.5683952755903,
        3579.720542913386,
        3579.8726952755906,
        3580.024842913386,
        3580.1769952755903,
        3580.3291952755903,
        3580.481342913386,
        3580.6334952755906,
        3580.785642913386,
        3580.9377952755904,
        3581.0899429133856,
        3581.2420952755906,
        3581.394242913386,
        3581.5463952755904,
        3581.6985952755904,
        3581.850742913386,
        3582.0028952755906,
        3582.155042913386,
        3582.3071952755904,
        3582.4593952755904,
        3582.611542913386,
        3582.7636952755906,
        3582.915842913386,
        3583.0679952755904,
        3583.2201952755904,
        3583.372342913386,
        3583.5244952755907,
        3583.676642913386,
        3583.8287952755904,
        3583.9809952755904,
        3584.1331429133857,
        3584.2852952755907,
        3584.4374952755907,
        3584.589642913386,
        3584.7417952755904,
        3584.8939952755904,
        3585.0461429133857,
        3585.19829527559,
        3585.35049527559,
        3585.502642913386,
        3585.6547952755905,
        3585.8069952755905,
        3585.9591429133857,
        3586.1112952755902,
        3586.2634952755902,
        3586.415642913386,
        3586.5677952755905,
        3586.7199952755905,
        3586.8721952755905,
        3587.0243429133857,
        3587.1764952755902,
        3587.3286952755902,
        3587.480842913386,
        3587.6329952755905,
        3587.7851952755905,
        3587.9373952755905,
        3588.0895429133857,
        3588.2416952755902,
        3588.3938952755902,
        3588.5460952755902,
        3588.698242913386,
        3588.8503952755905,
        3589.0025952755905,
        3589.1547952755905,
        3589.3069429133857,
        3589.4590952755902,
        3589.6112952755902,
        3589.7634952755902,
        3589.91569527559,
        3590.067842913386,
        3590.2199952755905,
        3590.3721952755905,
        3590.5243952755905,
        3590.6765952755904,
        3590.8287429133857,
        3590.9808952755902,
        3591.13309527559,
        3591.2852952755907,
        3591.4374952755907,
        3591.589642913386,
        3591.7417952755904,
        3591.8939952755904,
        3592.0461952755904,
        3592.1983952755904,
        3592.3505952755904,
        3592.5027952755904,
        3592.654942913386,
        3592.8070952755907,
        3592.9592952755906,
        3593.1114952755906,
        3593.2636952755906,
        3593.4158952755906,
        3593.5680952755906,
        3593.720242913386,
        3593.8723952755904,
        3594.0245952755904,
        3594.1767952755904,
        3594.3289952755904,
        3594.4811952755904,
        3594.6333952755904,
        3594.7855952755904,
        3594.9377952755904,
        3595.0899952755904,
        3595.2421952755903,
        3595.394342913386,
        3595.5464952755906,
        3595.6986952755906,
        3595.8508952755906,
        3596.0030952755906,
        3596.1552952755906,
        3596.3074952755906,
        3596.4596952755905,
        3596.6118952755905,
        3596.7640952755905,
        3596.9162952755905,
        3597.0684952755905,
        3597.2206952755905,
        3597.3728952755905,
        3597.5250952755905,
        3597.6772952755905,
        3597.8294952755905,
        3597.9816952755905,
        3598.1338952755905,
        3598.2860952755905,
        3598.4382952755905,
        3598.5904952755905,
        3598.7426952755904,
        3598.8948952755904,
        3599.0470952755904,
        3599.1992952755904,
        3599.3514952755904,
        3599.5036952755904,
        3599.6558952755904,
        3599.8080952755904,
        3599.9602952755904,
        3600.1124952755904,
        3600.2646952755904,
        3600.4168952755904,
        3600.5690952755904,
        3600.7212952755904,
        3600.8734952755904,
        3601.0256952755904,
        3601.1778952755903,
        3601.3300952755903,
        3601.4822952755903,
        3601.6344952755903,
        3601.786747637795,
        3601.9389952755905,
        3602.0911952755905,
        3602.2433952755905,
        3602.3955952755905,
        3602.5477952755905,
        3602.6999952755905,
        3602.8521952755905,
        3603.0043952755905,
        3603.1565952755905,
        3603.308847637795,
        3603.4610952755907,
        3603.6132952755906,
        3603.7654952755906,
        3603.9176952755906,
        3604.0698952755906,
        3604.2220952755906,
        3604.3742952755906,
        3604.5265476377954,
        3604.6787952755903,
        3604.8309952755903,
        3604.9831952755903,
        3605.1353952755903,
        3605.2875952755903,
        3605.439847637795,
        3605.5920952755905,
        3605.7442952755905,
        3605.8964952755905,
        3606.0486952755905,
        3606.2008952755905,
        3606.3531476377952,
        3606.5053952755907,
        3606.6575952755907,
        3606.8097952755907,
        3606.9620476377954,
        3607.1142952755904,
        3607.2664952755904,
        3607.4186952755904,
        3607.5708952755904,
        3607.723147637795,
        3607.8753952755906,
        3608.027595275591,
        3608.1797952755905,
        3608.3320476377953,
        3608.4842952755903,
        3608.6364952755903,
        3608.7886952755903,
        3608.940947637795,
        3609.0931952755905,
        3609.245395275591,
        3609.397647637795,
        3609.5498952755906,
        3609.7020952755906,
        3609.8542952755906,
        3610.0065476377954,
        3610.1587952755904,
        3610.3109952755904,
        3610.4632476377956,
        3610.6154952755905,
        3610.7676952755905,
        3610.9199476377953,
        3611.0721952755903,
        3611.2243952755903,
        3611.376647637795,
        3611.5288952755905,
        3611.681095275591,
        3611.833347637795,
        3611.9855952755906,
        3612.1377952755906,
        3612.2900476377954,
        3612.4422952755904,
        3612.594547637795,
        3612.7467952755906,
        3612.898995275591,
        3613.0512476377953,
        3613.2034952755903,
        3613.355747637795,
        3613.5079952755905,
        3613.6601952755905,
        3613.8124476377952,
        3613.9646952755907,
        3614.1169476377954,
        3614.2691952755904,
        3614.4213952755904,
        3614.573647637795,
        3614.7258952755906,
        3614.8781476377953,
        3615.0303952755903,
        3615.182647637795,
        3615.334895275591,
        3615.4871476377953,
        3615.6393952755902,
        3615.791647637795,
        3615.9438952755904,
        3616.0960952755904,
        3616.248347637795,
        3616.4005952755906,
        3616.5528476377954,
        3616.7050952755903,
        3616.857347637795,
        3617.0095952755905,
        3617.1618476377953,
        3617.3140952755903,
        3617.466347637795,
        3617.6185952755905,
        3617.7708476377957,
        3617.9230952755906,
        3618.0753476377954,
        3618.227647637795,
        3618.3798952755906,
        3618.5321476377953,
        3618.6843952755903,
        3618.836647637795,
        3618.988895275591,
        3619.1411476377953,
        3619.2933952755902,
        3619.445647637795,
        3619.597947637795,
        3619.7501952755906,
        3619.9024476377954,
        3620.0546952755903,
        3620.2069476377956,
        3620.3591952755905,
        3620.5114476377953,
        3620.663747637795,
        3620.8159952755905,
        3620.9682476377952,
        3621.1204952755907,
        3621.2727476377954,
        3621.4250476377956,
        3621.5772952755906,
        3621.7295476377953,
        3621.881847637795,
        3622.0340952755905,
        3622.1863476377953,
        3622.3385952755903,
        3622.490847637795,
        3622.6431476377957,
        3622.7953952755906,
        3622.9476476377954,
        3623.099947637795,
        3623.2521952755906,
        3623.4044476377953,
        3623.556747637795,
        3623.7089952755905,
        3623.8612476377953,
        3624.013547637795,
        3624.1657952755904,
        3624.318047637795,
        3624.4703476377954,
        3624.6225952755904,
        3624.774847637795,
        3624.9271476377953,
        3625.0794476377955,
        3625.2316952755905,
        3625.3839476377952,
        3625.536247637795,
        3625.6884952755904,
        3625.840747637795,
        3625.9930476377954,
        3626.145347637795,
        3626.297595275591,
        3626.4498476377953,
        3626.602147637795,
        3626.7544476377952,
        3626.9066952755907,
        3627.0589476377954,
        3627.211247637795,
        3627.3635476377954,
        3627.515795275591,
        3627.668047637795,
        3627.8203476377953,
        3627.972647637795,
        3628.1249476377952,
        3628.2771952755907,
        3628.4294476377954,
        3628.581747637795,
        3628.7340476377954,
        3628.886347637795,
        3629.0385952755905,
        3629.1908476377953,
        3629.343147637795,
        3629.495447637795,
        3629.6477476377954,
        3629.7999952755904,
        3629.9522476377956,
        3630.1045476377953,
        3630.256847637795,
        3630.4091476377953,
        3630.561447637795,
        3630.7136952755905,
        3630.865947637795,
        3631.0182476377954,
        3631.1705476377956,
        3631.3228476377953,
        3631.475147637795,
        3631.6274476377953,
        3631.7796952755903,
        3631.931947637795,
        3632.084247637795,
        3632.2365476377954,
        3632.3888476377956,
        3632.5411476377953,
        3632.693447637795,
        3632.8457476377953,
        3632.998047637795,
        3633.1502952755905,
        3633.302547637795,
        3633.4548476377954,
        3633.6071476377956,
        3633.7594476377953,
        3633.911747637795,
        3634.0640476377953,
        3634.216347637795,
        3634.368647637795,
        3634.5209476377954,
        3634.673247637795,
        3634.8255476377954,
        3634.977847637795,
        3635.1301476377953,
        3635.282447637795,
        3635.434747637795,
        3635.5870476377954,
        3635.739347637795,
        3635.8916476377954,
        3636.0439476377956,
        3636.1962476377953,
        3636.348547637795,
        3636.5008476377952,
        3636.6531476377954,
        3636.805447637795,
        3636.9577476377954,
        3637.110047637795,
        3637.2623476377953,
        3637.414647637795,
        3637.5669476377952,
        3637.7192476377954,
        3637.871547637795
    ]
}


class MyTest(unittest.TestCase):
    def test_unit_breakdown(self):
        data = pd.read_csv("csv/initial_data.csv")

        gr = data.GR.values
        tvd = data.TVD.values

        data = {
            "GR": list(gr),
            "TVD": list(tvd)
        }

        headers = {'content-type': 'application/json'}
        url = 'https://ai-facies.i2g.cloud/api/v1/unit-breakdown'

        resFromCsv = requests.post(url, data=json.dumps(data), headers=headers, verify=False)

        dataFromCsv = json.loads(resFromCsv.text)

        print(dataFromCsv["content"])

        resFromWi = requests.post(url, data=json.dumps(dct), headers=headers, verify=False)

        dataFromWi = json.loads(resFromWi.text)

        print(dataFromWi["content"])

    def test_expert_rule(self):
        initial_data = pd.read_csv("csv/initial_data.csv")

        gr = initial_data.GR.values
        tvd = initial_data.TVD.values

        data = {
            "GR": list(gr),
            "TVD": list(tvd)
        }

        headers = {'content-type': 'application/json'}
        url = 'http://127.0.0.1:9999/api/v1/unit-breakdown'

        res1 = requests.post(url, data=json.dumps(data), headers=headers)

        ub = json.loads(res1.text)

        ub = ub["content"]

        dct = {}
        dct.update({"Boundary_flag": ub})
        for key, value in initial_data.items():
            dct.update({key: list(value)})

        url = 'http://0.0.0.0:9999/api/v1/expert-rule'

        res2 = requests.post(url, data=json.dumps(dct), headers=headers)

        data1 = json.loads(res2.text)


        data1 = data1["content"]


        tmp = []
        for i in range(len(data1["Boundary_flag"])):
            t = {}
            for key in data1.keys():
                t.update({key: data1[key][i]})

            tmp.append(deepcopy(t))

        utils_func.export_to_csv(tmp, "csv/T2X.csv")
        # print(data)

        # if data["success"]:
        #     headers = list(data["payload"][0].keys())
        #     print(data["payload"][0])


if __name__ == '__main__':
    unittest.main()
